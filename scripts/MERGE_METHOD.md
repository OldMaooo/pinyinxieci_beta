# 词库合并方法文档

## 背景

原始数据来自PDF教材，有两个表：
- **写字表**：单字（1-25课）
- **词语表**：多字词（部分课）

## 合并规则

**最终总表 = 词语表（全部） + 写字表（去重后转成词）**

### 处理逻辑

| 写字表中的字 | 是否已在词语表中 | 处理方式 |
|-------------|-----------------|---------|
| "诗" | ❌ | 转成词 "古诗" |
| "冲" | ✅ "冲动"中 | 跳过 |
| "碧" | ✅ "碧绿"中 | 跳过 |

### 每个课的处理

1. 收集词语表中该课的所有词
2. 遍历写字表的字：
   - 如果字已在任何词语中（包含关系）→ 跳过
   - 如果不在 → 用 `charToWordMap` 转成双字词
3. 去重后输出

## 课名处理

- 写字表：1-25课（完整）
- 词语表：2-14, 16-25 + 识字1-4
- **总表课名**：取并集并排序（数字课在前，识字课在后）

## 使用方法

```bash
# 生成纯净版MD和JSON
node scripts/merge-final-table.cjs AI_Data_Generation_Kit/intermediate_data/[年级册次].md [年级册次]

# 示例：生成二年级下册
node scripts/merge-final-table.cjs AI_Data_Generation_Kit/intermediate_data/二年级下册.md 二年级下册
```

## 输出文件

- `scripts/extracted-final-tables/[年级册次]-纯净版.md` - 纯净版MD
- `dist/data/[年级册次].json` - 词库JSON

## 词数统计

| 学期 | 词数 |
|------|------|
| 一年级上册 | 229 |
| 一年级下册 | 325 |
| 二年级上册 | 487 |
| 二年级下册 | 353 |
| 三年级上册 | 208 |
| 三年级下册 | 214 |

## 注意事项

1. **课1和课15**：词语表没有，只有写字表
2. **识字1-4**：需要额外处理生字转词
3. **字符映射表**：`charToWordMap` 需要持续维护完善
