import { pinyin } from 'pinyin-pro';
import fs from 'fs';

// Read original data
const data = JSON.parse(fs.readFileSync('./public/data/一年级上册.json', 'utf-8'));

// Word expansion mappings based on Grade 1 textbook context
const wordExpansions = {
  '天': '天空',
  '地': '土地',
  '人': '人民',
  '你': '你们',
  '我': '我们',
  '他': '他家',
  '一': '一起',
  '二': '两个',
  '三': '三个',
  '四': '四个',
  '五': '五个',
  '上': '上课',
  '下': '下来',
  '口': '耳朵',
  '耳': '耳朵',
  '目': '眼睛',
  '手': '手掌',
  '足': '双脚',
  '站': '站立',
  '坐': '坐下',
  '日': '日子',
  '月': '月亮',
  '山': '大山',
  '川': '四川',
  '水': '清水',
  '火': '大火',
  '田': '田地',
  '禾': '禾苗',
  '爸': '鸹爸',
  '妈': '鸹妈',
  '大': '大小',
  '马': '小马',
  '路': '大路',
  '土': '泥土',
  '哥': '哥哥',
  '弟': '弟弟',
  '画': '画画',
  '花': '花朵',
  '打': '打球',
  '棋': '下棋',
  '积': '积木',
  '木': '木头',
  '学': '上课',
  '字': '生字',
  '词': '生词',
  '句': '句子',
  '子': '孩子',
  '桌': '桌子',
  '纸': '纸张',
  '读': '读书',
  '鸟': '小鸟',
  '乌': '乌鸦',
  '鸦': '乌鸦',
  '鱼': '小鱼',
  '鸭': '小鸭',
  '鸡': '小鸡',
  '星': '星星',
  '期': '星期',
  '语': '语文',
  '文': '文章',
  '数': '数目',
  '写': '写字',
  '会': '开',
  '秋': '秋天',
  '气': '空气',
  '了': '吃完',
  '树': '大树',
  '叶': '树叶',
  '黄': '黄色',
  '片': '一片',
  '从': '从来',
  '来': '来了',
  '飞': '小鸟',
  '江': '江河',
  '南': '南方',
  '可': '可以',
  '采': '采花',
  '莲': '莲花',
  '戏': '戏玩',
  '力': '用力',
  '尖': '笔尖',
  '尘': '灰尘',
  '众': '众人',
  '双': '双手',
  '林': '树林',
  '森': '森林',
  '不': '不是',
  '条': '金条',
  '心': '开心',
  '金': '金子',
  '包': '书包',
  '尺': '尺子',
  '作': '作业',
  '业': '作业',
  '笔': '铅笔',
  '刀': '小刀',
  '宝': '宝贝',
  '贝': '贝壳',
  '少': '很少',
  '课': '课本',
  '早': '早上',
  '升': '上升',
  '国': '中国',
  '旗': '红旗',
  '中': '中国',
  '们': '我们',
  '声': '大声',
  '起': '起床',
  '多': '很多',
  '么': '什么',
  '向': '向东',
  '立': '站立',
  '船': '大船',
  '弯': '弯弯',
  '儿': '孩子',
  '两': '两个',
  '头': '脑袋',
  '在': '在家',
  '里': '屋里',
  '看': '看书',
  '见': '看见',
  '闪': '闪电',
  '影': '电影',
  '前': '以前',
  '常': '平常',
  '黑': '黑色',
  '狗': '小狗',
  '左': '左手',
  '右': '右手',
  '它': '小猫',
  '好': '很好',
  '朋': '朋友',
  '友': '好友',
  '伴': '伙伴',
  '牛': '大牛',
  '羊': '小羊',
  '爪': '爪子',
  '比': '比较',
  '尾': '尾巴',
  '巴': '尾巴',
  '谁': '是谁',
  '长': '长短',
  '短': '长短',
  '把': '把玩',
  '伞': '雨伞',
  '兔': '小兔',
  '最': '最好',
  '公': '公鸡',
  '喝': '喝水',
  '只': '只是',
  '处': '到处',
  '找': '寻找',
  '着': '穿着',
  '许': '也许',
  '石': '石头',
  '出': '出去',
  '法': '方法',
  '放': '放下',
  '进': '进来',
  '高': '高高',
  '点': '一点',
  '数': '数数',
  '彩': '彩云',
  '半': '半天',
  '空': '空地',
  '问': '询问',
  '回': '回答',
  '答': '答案',
  '方': '方法',
  '久': '很久',
  '更': '更加',
  '长': '长辈',
  '牛': '黄牛',
  '羊': '白羊',
  '爪': '鸡爪',
  '拼': '拼写',
  '音': '声音',
  '元': '节日',
  '六': '六角',
  '七': '七月',
  '八': '八月',
  '九': '九月',
  '十': '十月',
  '开': '开门',
  '间': '时间',
  '东': '东边',
  '北': '北边',
  '的': '有的',
  '家': '回家',
  '竹': '竹子',
  '用': '用心',
  '不': '不好',
  '和': '和平',
  '做': '做事',
  '也': '也是',
  '又': '又是',
  '能': '能够',
  '着': '穿着',
  '说': '说话',
  '是': '就是',
  '春': '春天',
  '青': '青草',
  '蛙': '蛙子',
  '夏': '夏天',
  '皮': '皮肤',
  '就': '就是',
  '冬': '冬天',
  '对': '对话',
  '歌': '唱歌',
  '雨': '下雨',
  '风': '大风',
  '虫': '小虫',
  '清': '清澈',
  '绿': '绿色',
  '桃': '桃子',
  '红': '红色',
  '有': '有人',
  '和': '和平',
  '做': '做事',
  '也': '也是',
  '到': '迟到',
  '牙': '牙齿',
  '几': '几个',
  '步': '脚步',
  '没': '没有',
  '参': '参加',
  '加': '加入',
  '办': '办公',
  '才': '才能'
};

// Process words
const expandedWords = data.wordBank.map(item => {
  const expandedWord = wordExpansions[item.word] || item.word;
  return {
    ...item,
    word: expandedWord,
    pinyin: pinyin(expandedWord, { toneType: 'symbol' })
  };
});

// Update metadata
const newData = {
  ...data,
  buildDate: new Date().toISOString(),
  count: expandedWords.length,
  wordBank: expandedWords
};

// Write back
fs.writeFileSync('./public/data/一年级上册.json', JSON.stringify(newData, null, 2), 'utf-8');

console.log('✅ Expanded 一年级上册:');
console.log(`  Total words: ${expandedWords.length}`);
console.log(`  Single chars: ${data.wordBank.filter(w => w.word.length < 2).length}`);
console.log(`  Expanded to: ${expandedWords.filter(w => w.word.length >= 2).length}`);
