<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>ç‚¹å‡»è¿è¡Œæµ‹è¯•</title>
  <style>
    body { font-family: system-ui; padding: 40px; max-width: 600px; margin: 0 auto; text-align: center; }
    button { 
      font-size: 20px; 
      padding: 15px 30px; 
      background: #2563eb; 
      color: white; 
      border: none; 
      border-radius: 8px; 
      cursor: pointer;
      margin: 20px;
    }
    button:hover { background: #1d4ed8; }
    #result { 
      margin-top: 30px; 
      text-align: left; 
      background: #1e1e1e; 
      color: #d4d4d4; 
      padding: 20px; 
      border-radius: 8px;
      font-family: monospace;
      white-space: pre-wrap;
    }
    .note { 
      background: #fef3c7; 
      padding: 15px; 
      border-radius: 8px; 
      margin: 20px 0;
    }
  </style>
</head>
<body>
  <h1>ğŸ“Š æŒæ¡çŠ¶æ€æµ‹è¯•</h1>
  
  <div class="note">
    <strong>ä½¿ç”¨æ–¹æ³•ï¼š</strong><br>
    ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®åï¼Œæµè§ˆå™¨ä¼šå¼¹å‡ºä¸€ä¸ªæç¤ºæ¡†ï¼Œ<br>
    è¯¢é—®æ˜¯å¦å…è®¸è¿è¡Œè„šæœ¬ï¼Œ<br>
    ç‚¹å‡» <strong>"å…è®¸"</strong> å³å¯ã€‚
  </div>

  <button id="runTest">ğŸŸ¢ ç‚¹å‡»è¿è¡Œæµ‹è¯•</button>

  <div id="result"></div>

  <script>
    document.getElementById('runTest').onclick = function() {
      const testCode = `
        const testMastery = () => {
          if (!window.mastery) {
            alert('âŒ mastery æ•°æ®æœªåŠ è½½ï¼\\n\\nè¯·ç¡®ä¿:\\n1. åº”ç”¨å·²æ‰“å¼€ (http://localhost:3009)\\n2. é¡µé¢æ˜¾ç¤º"äº‘ç«¯å°±ç»ª"\\n3. ç­‰å¾…å‡ ç§’è®©æ•°æ®åŒæ­¥');
            return;
          }
          
          const mastery = window.mastery;
          const wordIds = Object.keys(mastery);
          const stats = { MASTERED: 0, WEAK: 0, NEW: 0, noData: 0 };
          const examples = { MASTERED: [], WEAK: [], NEW: [] };
          
          wordIds.forEach(id => {
            const m = mastery[id];
            if (!m || !m.history || m.history.length === 0) {
              stats.noData++;
              return;
            }
            const consecutiveGreen = m.consecutive_green || 0;
            const lastResult = m.history[m.history.length - 1];
            if (consecutiveGreen >= 5) {
              stats.MASTERED++;
              if (examples.MASTERED.length < 3) examples.MASTERED.push(id);
            } else if (lastResult === 'red') {
              stats.WEAK++;
              if (examples.WEAK.length < 3) examples.WEAK.push(id);
            } else {
              stats.NEW++;
              if (examples.NEW.length < 3) examples.NEW.push(id);
            }
          });
          
          const result = 'â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n' +
            'ğŸ“Š æŒæ¡çŠ¶æ€ç»Ÿè®¡\\n' +
            'â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n' +
            'âœ… æŒæ¡ (è¿ç»­ 5 å¤©ä»¥ä¸Šéƒ½ç­”å¯¹): ' + stats.MASTERED + '\\n' +
            'âŒ è–„å¼± (æœ€åä¸€æ¬¡ç­”é”™): ' + stats.WEAK + '\\n' +
            'ğŸ†• æ–°è¯ (æ— å†å²æˆ–æœ€è¿‘ç­”å¯¹): ' + stats.NEW + '\\n' +
            'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-\\n' +
            'æ€»è®¡: ' + wordIds.length + ' ä¸ªè¯ç»„\\n' +
            'â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n\\n' +
            'ğŸ“ ç¤ºä¾‹è¯ç»„:\\n' +
            '- æŒæ¡è¯ç»„: ' + (examples.MASTERED.join(', ') || 'æ— ') + '\\n' +
            '- è–„å¼±è¯ç»„: ' + (examples.WEAK.join(', ') || 'æ— ') + '\\n' +
            '- æ–°è¯: ' + (examples.NEW.join(', ') || 'æ— ') + '\\n\\n' +
            'ğŸ’¡ è¯·å¯¹æ¯” Setup é¡µé¢çš„ä¸‹åˆ’çº¿æ•°é‡ï¼š\\n' +
            'ğŸ”´ çº¢è‰²ä¸‹åˆ’çº¿ â‰ˆ ' + stats.WEAK + ' ä¸ªè¯ç»„\\n' +
            'ğŸŸ¢ ç»¿è‰²ä¸‹åˆ’çº¿ â‰ˆ ' + stats.MASTERED + ' ä¸ªè¯ç»„';
          
          alert(result);
          return result;
        };
        testMastery();
      `;
      
      // ä½¿ç”¨ location.href è¿è¡Œä»£ç 
      window.location.href = 'javascript:' + encodeURIComponent(testCode);
    };
  </script>
</body>
</html>
